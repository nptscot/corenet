<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function transforms a spatial network object into an 'sfnetwork', scoring it based on road conditions and classifications.
The transformation process includes casting the network to LINESTRING, converting it to 'sfnetwork', and adding attributes
like 'arterialness' and 'weight' which are calculated based on the given road scores and the importance of the roads in the network."><title>Prepare a network data structure by transforming, scoring, and weighting based on road types and conditions — prepare_network • corenet</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Prepare a network data structure by transforming, scoring, and weighting based on road types and conditions — prepare_network"><meta property="og:description" content="This function transforms a spatial network object into an 'sfnetwork', scoring it based on road conditions and classifications.
The transformation process includes casting the network to LINESTRING, converting it to 'sfnetwork', and adding attributes
like 'arterialness' and 'weight' which are calculated based on the given road scores and the importance of the roads in the network."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">corenet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Prepare a network data structure by transforming, scoring, and weighting based on road types and conditions</h1>
      
      <div class="d-none name"><code>prepare_network.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function transforms a spatial network object into an 'sfnetwork', scoring it based on road conditions and classifications.
The transformation process includes casting the network to LINESTRING, converting it to 'sfnetwork', and adding attributes
like 'arterialness' and 'weight' which are calculated based on the given road scores and the importance of the roads in the network.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">prepare_network</span><span class="op">(</span></span>
<span>  <span class="va">network</span>,</span>
<span>  key_attribute <span class="op">=</span> <span class="st">"all_fastest_bicycle_go_dutch"</span>,</span>
<span>  road_scores <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>`A Road` <span class="op">=</span> <span class="fl">1</span>, `B Road` <span class="op">=</span> <span class="fl">1</span>, `Minor Road` <span class="op">=</span> <span class="fl">1e+07</span><span class="op">)</span>,</span>
<span>  transform_crs <span class="op">=</span> <span class="fl">27700</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>network</dt>
<dd><p>An 'sf' object representing a spatial network.</p></dd>


<dt>key_attribute</dt>
<dd><p>The attribute name from the network used for normalization and scoring, default is "all_fastest_bicycle_go_dutch".</p></dd>


<dt>road_scores</dt>
<dd><p>A list specifying scores for different road types. Example: list("A Road" = 1, "B Road" = 1, "Minor Road" = 10000000).</p></dd>


<dt>transform_crs</dt>
<dd><p>The numeric CRS code for coordinate transformation, default is 27700.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An 'sfnetwork' object with attributes 'arterialness' and 'weight' that account for road conditions and their relative importance.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://luukvdmeer.github.io/sfnetworks/" class="external-link">sfnetworks</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/zonebuilders/zonebuilder" class="external-link">zonebuilder</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Load demo data </span></span></span>
<span class="r-in"><span><span class="va">os_edinburgh_demo_3km</span> <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_set_crs</a></span><span class="op">(</span><span class="va">os_edinburgh_demo_3km</span>, <span class="fl">27700</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">NPT_demo_3km</span> <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_set_crs</a></span><span class="op">(</span><span class="va">NPT_demo_3km</span>, <span class="fl">27700</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">base_network</span> <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">os_edinburgh_demo_3km</span>, crs <span class="op">=</span> <span class="fl">27700</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">influence_network</span> <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">NPT_demo_3km</span>, crs <span class="op">=</span> <span class="fl">27700</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">target_zone</span> <span class="op">=</span> <span class="fu">zonebuilder</span><span class="fu">::</span><span class="fu"><a href="https://zonebuilders.github.io/zonebuilder/reference/zb_zone.html" class="external-link">zb_zone</a></span><span class="op">(</span><span class="st">"Edinburgh"</span>, n_circles <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>               <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span>crs <span class="op">=</span> <span class="st">"EPSG:27700"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Prepare the cohesive network</span></span></span>
<span class="r-in"><span><span class="va">network</span> <span class="op">=</span> <span class="fu"><a href="cohesive_network_prep.html">cohesive_network_prep</a></span><span class="op">(</span>base_network <span class="op">=</span> <span class="va">base_network</span>, </span></span>
<span class="r-in"><span>                                influence_network <span class="op">=</span> <span class="va">influence_network</span>, </span></span>
<span class="r-in"><span>                                target_zone <span class="op">=</span> <span class="va">target_zone</span>, </span></span>
<span class="r-in"><span>                                key_attribute <span class="op">=</span> <span class="st">"road_function"</span>, </span></span>
<span class="r-in"><span>                                attribute_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A Road"</span>, <span class="st">"B Road"</span>, <span class="st">"Minor Road"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Requested number of segments (45185) does not match the number of segments returned by rsgeo (44530).</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>st_centroid assumes attributes are constant over geometries</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Joining with `by = join_by(road_function)`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Finished preparing the network data"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define road scores</span></span></span>
<span class="r-in"><span><span class="va">road_scores</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"A Road"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"B Road"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"Minor Road"</span> <span class="op">=</span> <span class="fl">100000</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Prepare the network</span></span></span>
<span class="r-in"><span><span class="va">prepared_network</span> <span class="op">=</span> <span class="fu">prepare_network</span><span class="op">(</span><span class="va">network</span>, </span></span>
<span class="r-in"><span>                                    key_attribute <span class="op">=</span> <span class="st">"all_fastest_bicycle_go_dutch"</span>,</span></span>
<span class="r-in"><span>                                    road_scores <span class="op">=</span> <span class="va">road_scores</span>,</span></span>
<span class="r-in"><span>                                    transform_crs <span class="op">=</span> <span class="fl">27700</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Print the prepared network</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">prepared_network</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #555555;"># A sfnetwork with</span> <span style="color: #555555;">1124</span> <span style="color: #555555;">nodes and</span> <span style="color: #555555;">1237</span> <span style="color: #555555;">edges</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #555555;">#</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #555555;"># CRS: </span> <span style="color: #555555;">EPSG:27700</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #555555;">#</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #555555;"># An undirected multigraph with 1 component with spatially explicit edges</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #555555;">#</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1,237 × 12</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    from    to road_function all_fastest_bicycle_go_dutch length_x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1     2 A Road                            1<span style="text-decoration: underline;">461</span>109.    0.190</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>     3     4 Minor Road                            919.  321.   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>     5     6 A Road                               <span style="text-decoration: underline;">8</span>154.   34.0  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>     7     8 A Road                               <span style="text-decoration: underline;">5</span>646.   49.1  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>     9    10 A Road                              <span style="text-decoration: underline;">10</span>655.   26.0  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>    11    12 Minor Road                           <span style="text-decoration: underline;">8</span>757.   33.7  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1,231 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 7 more variables: geom &lt;LINESTRING [m]&gt;, value &lt;dbl&gt;, min_value &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   max_value &lt;dbl&gt;, arterialness &lt;dbl&gt;, road_score &lt;dbl&gt;, weight &lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #555555;">#</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1,124 × 1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  geom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;POINT [m]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> (324910.8 672963.1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> (324910.7 672963.3)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>     (327256 672497)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1,121 more rows</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zhao Wang, Robin Lovelace.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

